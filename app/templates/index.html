<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ meta_title }}</title>
    <meta name="description" content="{{ meta_desc }}">
    <link rel="canonical" href="{{ meta_url }}">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ meta_url }}">
    <meta property="og:title" content="{{ meta_title }}">
    <meta property="og:description" content="{{ meta_desc }}">
    <meta property="og:image" content="{{ request.base_url.scheme }}://{{ request.base_url.netloc }}/static/img/og-image.png">
    
    <link rel="icon" href="/static/img/favicon.ico">
    <!-- CSS ë²„ì „ ì—…ë°ì´íŠ¸ -->
    <link rel="stylesheet" href="/static/css/style.css?v=5.0"> 
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="main-layout">
    
    <!-- [ê³ ì • ì˜ì—­ ì‹œì‘] Header + Search Panel -->
    <div class="fixed-top-area">
        
        <!-- 1. Header -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo-container">
                    <a href="/" class="logo">
                        <img src="/static/img/logo.png" alt="JP Campus" class="logo-img">
                    </a>
                </div>
                <div class="lang-switch">
                    <button onclick="setLanguage('en')">ğŸ‡ºğŸ‡¸</button>
                    <button onclick="setLanguage('ko')">ğŸ‡°ğŸ‡·</button>
                </div>
            </div>
        </header>

        <!-- 2. Search Panel -->
        <div id="detail-search-panel" class="detail-search-panel">
            <div class="search-wrapper">
                <div class="search-container">
                    <!-- 1. Region -->
                    <select id="filter-region">
                        <option value="all" data-i18n="opt_region_all">ğŸ“ Region (All)</option>
                        <optgroup label="Kanto">
                            <option value="æ–°å®¿">Shinjuku</option>
                            <option value="é«˜ç”°é¦¬å ´">Takadanobaba</option>
                            <option value="å¤§ä¹…ä¿">Shin-Okubo</option>
                            <option value="æ± è¢‹">Ikebukuro</option>
                            <option value="æ¸‹è°·">Shibuya</option>
                            <option value="æ—¥æš®é‡Œ">Nippori</option>
                            <option value="æ¨ªæµœ">Yokohama</option>
                            <option value="åŸ¼ç‰">Saitama</option>
                            <option value="åƒè‘‰">Chiba</option>
                        </optgroup>
                        <optgroup label="Kansai">
                            <option value="å¤§é˜ª">Osaka</option>
                            <option value="äº¬éƒ½">Kyoto</option>
                            <option value="ç¥æˆ¸">Kobe</option>
                        </optgroup>
                        <optgroup label="Others">
                            <option value="åŒ—æµ·é“">Hokkaido</option>
                            <option value="ç¦å²¡">Fukuoka</option>
                            <option value="åå¤å±‹">Nagoya</option>
                            <option value="æ²–ç¸„">Okinawa</option>
                        </optgroup>
                    </select>

                    <!-- 2. University -->
                    <div>
                        <input type="text" id="filter-univ" placeholder="ğŸ« Search Univ">
                    </div>

                    <!-- 3. Tuition -->
                    <select id="filter-price">
                        <option value="all" data-i18n="opt_price_all">ğŸ’° Tuition</option>
                        <option value="70">700k~ JPY</option>
                        <option value="75">Under 750k</option>
                        <option value="80">Under 800k</option>
                        <option value="85">Under 850k</option>
                    </select>

                    <!-- 4. Nationality -->
                    <select id="filter-nation">
                        <option value="all" data-i18n="opt_nation_all">ğŸŒ Nationality</option>
                        <option value="global">ğŸ‡ºğŸ‡¸ Global</option>
                        <option value="korea_low">ğŸ‡°ğŸ‡· Low KR</option>
                        <option value="china_high">ğŸ‡¨ğŸ‡³ High CN</option>
                        <option value="vietnam_high">ğŸ‡»ğŸ‡³ High VN</option>
                    </select>

                    <!-- 5. Size -->
                    <select id="filter-scale">
                        <option value="all" data-i18n="opt_scale_all">ğŸ‘¥ Size</option>
                        <option value="large">Large (500+)</option>
                        <option value="medium">Medium</option>
                        <option value="small">Small</option>
                    </select>

                    <!-- 6. Career -->
                    <select id="filter-career">
                        <option value="all" data-i18n="opt_career_all">ğŸ“ Career</option>
                        <option value="grad_school">Grad School</option>
                        <option value="university">University</option>
                        <option value="vocational">Vocational</option>
                    </select>

                    <!-- 7. Special -->
                    <select id="filter-special">
                        <option value="all" data-i18n="opt_special_all">ğŸ¯ Specialized</option>
                        <option value="art">ğŸ¨ Art/Design</option>
                        <option value="biz">ğŸ’¼ Business</option>
                        <option value="short">âœˆï¸ Short-term</option>
                        <option value="jlpt">ğŸ“š JLPT</option>
                    </select>

                    <!-- 8. Dorm -->
                    <select id="filter-dorm">
                        <option value="all" data-i18n="opt_dorm_all">ğŸ›ï¸ Dormitory</option>
                        <option value="yes">Available</option>
                        <option value="single">Single Room</option>
                        <option value="school_owned">School Owned</option>
                    </select>

                    <!-- 9. Scholarship -->
                    <select id="filter-scholarship">
                        <option value="all" data-i18n="opt_scholarship_all">ğŸ… Scholarship</option>
                        <option value="yes">Available</option>
                    </select>

                    <!-- 10. EJU -->
                    <select id="filter-eju">
                        <option value="all" data-i18n="opt_eju_all">ğŸ“ EJU Prep</option>
                        <option value="yes">Available</option>
                        <option value="science">âš—ï¸ Science</option>
                        <option value="art">ğŸ¨ Art</option>
                    </select>

                    <!-- 11. Style -->
                    <select id="filter-convo">
                        <option value="all" data-i18n="opt_convo_all">ğŸ—£ï¸ Style</option>
                        <option value="yes">Conversation</option>
                        <option value="activity">Activities</option>
                    </select>

                    <!-- 12. Environment -->
                    <select id="filter-env">
                        <option value="all" data-i18n="opt_env_all">ğŸ™ï¸ Environment</option>
                        <option value="active">City Center</option>
                        <option value="quiet">Quiet Area</option>
                    </select>
                </div>
                
                <div class="search-actions">
                    <button id="search-btn" class="apply-btn" onclick="applyFilters()">
                        <i class="fas fa-search"></i> <span data-i18n="search_btn">Search</span>
                    </button>
                    <button id="reset-btn" class="reset-btn" onclick="resetFilters()">
                        <i class="fas fa-undo"></i> <span data-i18n="reset_btn">Reset</span>
                    </button>
                </div>
            </div>
        </div>
    </div> 
    <!-- [ê³ ì • ì˜ì—­ ë] -->

    <!-- Map Section (ì „ì²´ ë„ˆë¹„) -->
    <section class="map-section">
        <div class="map-container-inner">
            <div id="map"></div>
        </div>
        <div class="map-overlay-info">
            <span data-i18n="txt_result">Results:</span> <span id="result-count" class="highlight">0</span> <span data-i18n="txt_schools">schools</span>
        </div>
    </section>

    <!-- [1] Floating Box (ì§€ë„ ìœ„ì— ê²¹ì¹˜ëŠ” ì œëª© ë°•ìŠ¤) -->
    <div class="floating-container">
        <div class="floating-box">
            <h2 data-i18n="page_title">Japan Language School Map Search & Compare</h2>
            <p>
                Compare schools based on <strong>Location, Tuition, Nationality Ratio, and Admission Records</strong>.
            </p>
            {% if updated_at %}
            <p style="margin-top: 15px; font-size: 0.85rem; color: #888;">
                <i class="fas fa-sync-alt"></i> Updated: {{ updated_at }}
            </p>
            {% endif %}
        </div>
    </div>

    <!-- [2] Guide Section (ë…ë¦½ì ì¸ í•˜ë‹¨ ì„¹ì…˜) -->
    <section class="guide-section">
        <div class="guide-wrapper">
            <h3 class="section-title" data-i18n="guide_main_title">ğŸ“š Essential Guides for Japan</h3>
            
            <div class="card-grid">
                <a href="/guide/cost" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=500');"></div>
                    <div class="card-body">
                        <h4 data-i18n="guide_cost_title">ğŸ’° 1-Year Cost Breakdown</h4>
                        <p data-i18n="guide_cost_desc">Realistic budget analysis for studying in Tokyo.</p>
                    </div>
                </a>
                <a href="/guide/school-choice" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=500');"></div>
                    <div class="card-body">
                        <h4 data-i18n="guide_school_title">ğŸ« 5 Criteria for Choosing</h4>
                        <p data-i18n="guide_school_desc">How to choose the right school for your goals.</p>
                    </div>
                </a>
                <a href="/guide/visa" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?w=500');"></div>
                    <div class="card-body">
                        <h4 data-i18n="guide_visa_title">âœˆï¸ Visa Application Guide</h4>
                        <p data-i18n="guide_visa_desc">Step-by-step guide to COE and visa application.</p>
                    </div>
                </a>
                <a href="/guide/housing" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=500');"></div>
                    <div class="card-body">
                        <h4 data-i18n="guide_housing_title">ğŸ  Dorm vs Share House</h4>
                        <p data-i18n="guide_housing_desc">Pros and cons of each housing type and costs.</p>
                    </div>
                </a>
            </div>
            
            <div style="text-align: center; margin-top: 50px;">
                <a href="/guide" class="apply-btn" style="display: inline-flex; width: auto; padding: 0 40px; text-decoration: none;" data-i18n="guide_view_all">View All Guides ></a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <h3>JP Campus</h3>
            <div class="footer-links">
                <a href="/guide">Guide</a>
                <a href="/about">About</a>
                <a href="/policy">Privacy</a>
                <a href="/contact">Contact</a>
            </div>
            <p class="copyright">Â© 2024 JP Campus. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>const SCHOOLS_DATA = {{ schools_json | safe }};</script>
    <script src="/static/js/i18n.js?v=2.5"></script>
    <script src="/static/js/map.js?v=2.5"></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
    <script 
        src="https://maps.googleapis.com/maps/api/js?key={{ maps_api_key }}&callback=initMap&libraries=marker&v=weekly" 
        async 
        defer>
    </script>
</body>
</html>