<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ meta_title }}</title>
    <meta name="description" content="{{ meta_desc }}">
    <link rel="canonical" href="{{ meta_url }}">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ meta_url }}">
    <meta property="og:title" content="{{ meta_title }}">
    <meta property="og:description" content="{{ meta_desc }}">
    <meta property="og:image" content="{{ request.base_url.scheme }}://{{ request.base_url.netloc }}/static/img/og-image.png">
    
    <link rel="icon" href="/static/img/favicon.ico">
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="main-layout">
    <header class="main-header">
        <div class="logo-container">
            <a href="/" class="logo">
                <img src="/static/img/logo.png" alt="JP Campus" class="logo-img">
            </a>
            <h1 class="site-desc" style="font-size: 1.2rem; font-weight: 500; color: #666; margin: 0;">
                일본 전국 일본어학교 지도 검색 & 비교 서비스, JP Campus
            </h1>
        </div>
        <div class="lang-switch">
            <button onclick="setLanguage('ko')">🇰🇷</button>
            <button onclick="setLanguage('ja')">🇯🇵</button>
            <button onclick="setLanguage('en')">🇺🇸</button>
        </div>
    </header>

    <div id="detail-search-panel" class="detail-search-panel">
        <div class="search-container">
            <select id="filter-region">
                <option value="all" data-i18n="opt_region_all">📍 지역 (전체)</option>
                <optgroup label="관동 지방 (도쿄권)">
                    <option value="新宿" data-i18n="opt_shinjuku">신주쿠 (新宿)</option>
                    <option value="高田馬場" data-i18n="opt_takadanobaba">다카다노바바 (高田馬場)</option>
                    <option value="大久保" data-i18n="opt_shinokubo">신오쿠보 (大久保)</option>
                    <option value="池袋" data-i18n="opt_ikebukuro">이케부쿠로 (池袋)</option>
                    <option value="渋谷" data-i18n="opt_shibuya">시부야 (渋谷)</option>
                    <option value="日暮里" data-i18n="opt_nippori">닛포리 (日暮里)</option>
                    <option value="神奈川" data-i18n="opt_yokohama">가나가와/요코하마 (神奈川)</option>
                    <option value="埼玉" data-i18n="opt_saitama">사이타마 (埼玉)</option>
                    <option value="千葉" data-i18n="opt_chiba">치바 (千葉)</option>
                </optgroup>
                <optgroup label="관서 지방">
                    <option value="大阪" data-i18n="opt_osaka">오사카 (大阪)</option>
                    <option value="京都" data-i18n="opt_kyoto">교토 (京都)</option>
                    <option value="兵庫" data-i18n="opt_kobe">효고/고베 (兵庫)</option>
                </optgroup>
                <optgroup label="그 외 주요 도시">
                    <option value="北海道" data-i18n="opt_sapporo">홋카이도 (北海道)</option>
                    <option value="愛知" data-i18n="opt_nagoya">아이치/나고야 (愛知)</option>
                    <option value="福岡" data-i18n="opt_fukuoka">후쿠오카 (福岡)</option>
                    <option value="沖縄">오키나와 (沖縄)</option>
                </optgroup>
            </select>

            <input type="text" id="filter-univ" placeholder="🏫 목표 대학 검색 (예: 早稲田, 明治)" class="search-input">

            <select id="filter-price"><option value="all" data-i18n="opt_price_all">💰 학비</option><option value="80" data-i18n="opt_price_80">80만엔↓</option><option value="85" data-i18n="opt_price_85">85만엔↓</option><option value="90" data-i18n="opt_price_90">90만엔↓</option></select>
            <select id="filter-nation"><option value="all" data-i18n="opt_nation_all">🌏 국적</option><option value="global" data-i18n="opt_global">🇺🇸 다국적</option><option value="korea_low" data-i18n="opt_kr_low">🇰🇷 한국인 소수</option><option value="china_high" data-i18n="opt_cn_high">🇨🇳 한자권</option><option value="vietnam_high" data-i18n="opt_vn_high">🇻🇳 동남아</option></select>
            <select id="filter-scale"><option value="all" data-i18n="opt_scale_all">👥 규모</option><option value="large" data-i18n="opt_scale_large">대규모</option><option value="medium" data-i18n="opt_scale_medium">중규모</option><option value="small" data-i18n="opt_scale_small">소수정예</option></select>
            <select id="filter-career"><option value="all" data-i18n="opt_career_all">🎓 진학</option><option value="grad_school" data-i18n="opt_career_grad">대학원</option><option value="university" data-i18n="opt_career_univ">대학</option><option value="vocational" data-i18n="opt_career_voc">전문학교</option></select>
            <select id="filter-special">
                <option value="all" data-i18n="opt_special_all">🎯 특화</option>
                <option value="art" data-i18n="opt_special_art">🎨 미술</option>
                <option value="biz" data-i18n="opt_special_biz">💼 비즈니스</option>
                <option value="short" data-i18n="opt_special_short">✈️ 단기/워홀</option>
                <option value="jlpt" data-i18n="opt_special_jlpt">📚 JLPT 집중</option>
            </select>
            <select id="filter-dorm">
                <option value="all" data-i18n="opt_dorm_all">🛏️ 기숙사</option>
                <option value="yes" data-i18n="opt_dorm_yes">있음</option>
                <option value="single" data-i18n="opt_dorm_single">👤 1인실</option>
            </select>
            <select id="filter-scholarship"><option value="all" data-i18n="opt_scholarship_all">🏅 장학금</option><option value="yes" data-i18n="opt_scholarship_yes">있음</option></select>
            <select id="filter-eju">
                <option value="all" data-i18n="opt_eju_all">📝 EJU</option>
                <option value="yes" data-i18n="opt_eju_yes">있음</option>
                <option value="science" data-i18n="opt_eju_science">⚗️ 이과/수학</option>
            </select>
            <select id="filter-convo"><option value="all" data-i18n="opt_convo_all">🗣️ 회화</option><option value="yes" data-i18n="opt_convo_yes">중심</option></select>
            <select id="filter-env"><option value="all" data-i18n="opt_env_all">🏙️ 환경</option><option value="quiet" data-i18n="opt_env_quiet">조용한 곳</option><option value="active" data-i18n="opt_env_active">번화가</option></select>
        </div>
        
        <div class="search-actions">
            <button id="search-btn" class="apply-btn" onclick="applyFilters()">
                <i class="fas fa-search"></i> <span data-i18n="btn_search">검색하기</span>
            </button>
            <button id="reset-btn" class="reset-btn" onclick="resetFilters()">
                <i class="fas fa-undo"></i> <span data-i18n="btn_reset">초기화</span>
            </button>
        </div>
    </div>

    <section class="map-section">
        <div id="map"></div>
        <div class="map-overlay-info">
            <span data-i18n="txt_result">결과:</span> <span id="result-count" class="highlight">0</span> <span data-i18n="txt_schools">개교</span>
        </div>
    </section>

    <main class="content-section">
        <div class="content-wrapper">
            <div class="guide-box">
                <h2>🏫 일본 전국 일본어학교 가이드</h2>
                <p>
                    성공적인 일본 유학의 첫걸음, 학교 선택이 가장 중요합니다. 
                    JP Campus는 <strong>위치, 학비, 국적 비율, 진학 실적</strong> 데이터를 기반으로 
                    여러분의 목표에 딱 맞는 학교를 찾아드립니다.
                </p>
                <div class="guide-points">
                    <span>💡 <strong>Tip:</strong> '목표 대학 검색' 기능을 통해 와세다(早稲田), 메이지(明治) 등 원하는 대학을 많이 보낸 학교를 찾아보세요!</span>
                </div>
                
                {% if updated_at %}
                <p style="margin-top: 15px; font-size: 0.85rem; color: #999;">
                    <i class="fas fa-sync-alt"></i> 데이터 최종 갱신: {{ updated_at }}
                </p>
                {% endif %}
            </div>

            <h3 class="section-title" style="margin-top: 60px;">📚 일본 유학 핵심 가이드</h3>
            <div class="card-grid">
                <a href="/guide/cost" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=500');"></div>
                    <div class="card-body">
                        <h4>💰 1년 비용 총정리</h4>
                        <p>학비, 기숙사비, 생활비까지. 도쿄 유학에 실제로 필요한 초기 자금과 예산을 분석합니다.</p>
                    </div>
                </a>
                <a href="/guide/school-choice" class="card">
                    <!-- [수정] 작동하는 이미지 URL로 변경 -->
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=500');"></div>
                    <div class="card-body">
                        <h4>🏫 학교 선택 기준 5가지</h4>
                        <p>진학, 취업, 회화 등 내 목적에 딱 맞는 일본어학교를 고르는 방법을 알려드립니다.</p>
                    </div>
                </a>
                <a href="/guide/visa" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1436491865332-7a61a109cc05?w=500');"></div>
                    <div class="card-body">
                        <h4>✈️ 비자 신청 완벽 가이드</h4>
                        <p>복잡한 서류 준비부터 COE 발급, 대사관 사증 신청까지 단계별로 정리했습니다.</p>
                    </div>
                </a>
                <a href="/guide/housing" class="card">
                    <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=500');"></div>
                    <div class="card-body">
                        <h4>🏠 기숙사 vs 원룸</h4>
                        <p>기숙사, 쉐어하우스, 자취 중 어디가 좋을까요? 장단점과 초기 비용을 비교해드립니다.</p>
                    </div>
                </a>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <a href="/guide" class="apply-btn" style="display: inline-block; width: auto; padding: 12px 40px; background: #3498db; text-decoration: none;">가이드 전체 보기 ></a>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="footer-content">
            <h3>JP Campus</h3>
            <!-- [수정] 파이프(|) 문자 제거 -->
            <div class="footer-links">
                <a href="/guide">유학 가이드</a>
                <a href="/about">사이트 소개</a>
                <a href="/policy">개인정보처리방침</a>
                <a href="/contact">문의하기</a>
            </div>
            <p class="copyright">© 2024 JP Campus. All rights reserved.</p>
        </div>
    </footer>

    <script>const SCHOOLS_DATA = {{ schools_json | safe }};</script>
    <script src="/static/js/i18n.js"></script>
    <script src="/static/js/map.js"></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{ maps_api_key }}&callback=initMap&v=weekly"></script>
</body>
</html>