<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ meta_title }}</title>
    <meta name="description" content="{{ meta_desc }}">
    <link rel="canonical" href="{{ meta_url }}">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ meta_url }}">
    <meta property="og:title" content="{{ meta_title }}">
    <meta property="og:description" content="{{ meta_desc }}">
    <meta property="og:image" content="{{ request.base_url.scheme }}://{{ request.base_url.netloc }}/static/img/og-image.png">
    
    <link rel="icon" href="/static/img/favicon.ico">
    <link rel="stylesheet" href="/static/css/style.css?v=5.3"> 
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- êµ¬ê¸€ ì• ë“œì„¼ìŠ¤ (ìë™ ê´‘ê³ ) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8780435268193938" crossorigin="anonymous"></script>
</head>
<body class="main-layout">
    
    <div class="fixed-top-area">
        <header class="main-header">
            <div class="header-content">
                <a href="/" class="logo"><img src="/static/img/logo.png" alt="JP Campus" class="logo-img"></a>
            </div>
        </header>

        <div class="detail-search-panel">
            <div class="search-wrapper">
                <div class="search-container">
                    <select id="filter-region">
                        <option value="all">ğŸ“ Region (All)</option>
                        <optgroup label="Kanto">
                            <option value="æ–°å®¿">Shinjuku</option>
                            <option value="é«˜ç”°é¦¬å ´">Takadanobaba</option>
                            <option value="å¤§ä¹…ä¿">Shin-Okubo</option>
                            <option value="æ± è¢‹">Ikebukuro</option>
                            <option value="æ¸‹è°·">Shibuya</option>
                            <option value="æ—¥æš®é‡Œ">Nippori</option>
                            <option value="æ¨ªæµœ">Yokohama</option>
                            <option value="åŸ¼ç‰">Saitama</option>
                            <option value="åƒè‘‰">Chiba</option>
                        </optgroup>
                        <optgroup label="Kansai">
                            <option value="å¤§é˜ª">Osaka</option>
                            <option value="äº¬éƒ½">Kyoto</option>
                            <option value="ç¥æˆ¸">Kobe</option>
                        </optgroup>
                        <optgroup label="Others">
                            <option value="åŒ—æµ·é“">Hokkaido</option>
                            <option value="ç¦å²¡">Fukuoka</option>
                            <option value="åå¤å±‹">Nagoya</option>
                            <option value="æ²–ç¸„">Okinawa</option>
                        </optgroup>
                    </select>
                    <div><input type="text" id="filter-univ" placeholder="ğŸ« Search Name"></div>
                    <select id="filter-price"><option value="all">ğŸ’° Tuition (1yr)</option><option value="70">700k~ JPY</option><option value="75">Under 750k</option><option value="80">Under 800k</option><option value="85">Under 850k</option></select>
                    <select id="filter-nation"><option value="all">ğŸŒ Nationality</option><option value="global">ğŸ‡ºğŸ‡¸ Global / Western</option><option value="korea_low">ğŸ‡°ğŸ‡· Low Korean Ratio</option><option value="china_high">ğŸ‡¨ğŸ‡³ High Chinese</option><option value="vietnam_high">ğŸ‡»ğŸ‡³ High Vietnamese</option></select>
                    <select id="filter-scale"><option value="all">ğŸ‘¥ Size</option><option value="large">Large (500+)</option><option value="medium">Medium</option><option value="small">Small</option></select>
                    <select id="filter-career"><option value="all">ğŸ“ Career Focus</option><option value="grad_school">Grad School</option><option value="university">University</option><option value="vocational">Vocational / Job</option></select>
                </div>
                <div class="search-actions">
                    <button id="search-btn" class="apply-btn" onclick="applyFilters()"><i class="fas fa-search"></i> Search</button>
                    <button id="reset-btn" class="reset-btn" onclick="resetFilters()"><i class="fas fa-undo"></i> Reset</button>
                </div>
            </div>
        </div>
    </div> 

    <!-- í†µê³„ ë°°ì§€ -->
    <div class="stats-bar-container notranslate" translate="no">
        <div class="stats-badges">
            <span class="badge-item badge-blue"><i class="fas fa-building"></i> <strong>{{ school_count }}</strong> Schools Listed</span>
            <span class="badge-item badge-orange"><i class="fas fa-sync-alt"></i> Updating Weekly</span>
        </div>
    </div>

    <!-- Map Section -->
    <section class="map-section">
        <div class="map-container-inner"><div id="map"></div></div>
        <div class="map-overlay-info">Results: <span id="result-count" class="highlight">0</span> schools</div>
    </section>

    <!-- Floating Box -->
    <div class="floating-container">
        <div class="floating-box">
            <h2>Japan Language School Map Search & Compare</h2>
            <p>Compare schools based on <strong>Location, Tuition, Nationality Ratio, and Admission Records</strong>.</p>
        </div>
    </div>

    <!-- Schools & Univs Lists (ìƒëµ - ê¸°ì¡´ê³¼ ë™ì¼) -->
    {% if latest_schools %}
    <section class="school-section" style="background-color: #fff; padding: 80px 0; border-top: 1px solid #f0f0f0;">
        <div class="content-wrapper">
            <h3 class="section-title">ğŸ« Featured Language Schools</h3>
            <div class="card-grid">
                {% for item in latest_schools %}
                {% set school_imgs = ['https://images.unsplash.com/photo-1544531586-fde5298cdd40?w=500','https://images.unsplash.com/photo-1580582932707-520aed937b7b?w=500','https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=500','https://images.unsplash.com/photo-1491841550275-ad7854e35ca6?w=500'] %}
                {% set current_img = school_imgs[loop.index0 % 4] %}
                <a href="{{ item.link }}" class="card">
                    <div class="card-img" style="background-image: url('{{ current_img }}');">
                        <div style="position:absolute; top:10px; right:10px; background:rgba(255,255,255,0.9); padding:5px; border-radius:50%; width:32px; height:32px; display:flex; align-items:center; justify-content:center;"><img src="/static/img/pin-school.png" style="width:18px;"></div>
                    </div>
                    <div class="card-body">
                        <h4>{{ item.basic_info.name_ja }}</h4>
                        <p><i class="fas fa-map-marker-alt" style="color: #e67e22;"></i> {{ item.basic_info.address[:15] }}...</p>
                    </div>
                </a>
                {% endfor %}
            </div>
            <div style="text-align: center; margin-top: 50px;"><a href="/schools" class="apply-btn" style="display: inline-flex; width: auto; padding: 0 40px;">View All Schools ></a></div>
        </div>
    </section>
    {% endif %}

    {% if latest_universities %}
    <section class="univ-section" style="background-color: #f9f9f9; padding: 80px 0; border-top: 1px solid #eee;">
        <div class="content-wrapper">
            <h3 class="section-title">ğŸ“ Featured Universities</h3>
            <div class="card-grid">
                {% for item in latest_universities %}
                {% set univ_imgs = ['https://images.unsplash.com/photo-1562774053-701939374585?w=500', 'https://images.unsplash.com/photo-1498243691581-b145c3f54a5a?w=500', 'https://images.unsplash.com/photo-1592280771190-3e2e4d571952?w=500', 'https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=500'] %}
                {% set current_univ_img = univ_imgs[loop.index0 % 4] %}
                <a href="{{ item.link }}" class="card">
                    <div class="card-img" style="background-image: url('{{ current_univ_img }}');">
                        <div style="position:absolute; top:10px; right:10px; background:rgba(255,255,255,0.9); padding:5px; border-radius:50%; width:32px; height:32px; display:flex; align-items:center; justify-content:center;"><img src="/static/img/pin-univ.png" style="width:18px;"></div>
                    </div>
                    <div class="card-body">
                        <h4>{{ item.basic_info.name_ja }}</h4>
                        <p><i class="fas fa-map-marker-alt" style="color: #3498db;"></i> {{ item.basic_info.address[:15] }}...</p>
                    </div>
                </a>
                {% endfor %}
            </div>
            <div style="text-align: center; margin-top: 50px;"><a href="/universities" class="apply-btn" style="display: inline-flex; width: auto; padding: 0 40px;">View All Universities ></a></div>
        </div>
    </section>
    {% endif %}

    {% if latest_guides %}
    <section class="guide-section">
        <div class="guide-wrapper">
            <h3 class="section-title">ğŸ“š Essential Guides for Japan</h3>
            <div class="card-grid">
                {% for guide in latest_guides %}
                <a href="{{ guide.link }}" class="card">
                    <div class="card-img" style="background-image: url('{{ guide.thumbnail }}');"></div>
                    <div class="card-body">
                        <span style="font-size: 0.8rem; color: #3498db; font-weight: bold;">{{ guide.category }}</span>
                        <h4 style="margin: 5px 0;">{{ guide.title }}</h4>
                        <p>{{ guide.description | truncate(60) }}</p>
                    </div>
                </a>
                {% endfor %}
            </div>
            <div style="text-align: center; margin-top: 50px;"><a href="/guide" class="apply-btn" style="display: inline-flex; width: auto; padding: 0 40px;">View All Guides ></a></div>
        </div>
    </section>
    {% endif %}

    <footer class="main-footer">
        <div class="footer-content">
            <a href="/" class="footer-logo-link"><img src="/static/img/logo.png" alt="JP Campus" class="footer-logo"></a>
            <div class="footer-links">
                <a href="/guide">Guide</a>
                <a href="/about">About</a>
                <a href="/policy">Privacy</a>
                <a href="/contact">Contact</a>
            </div>
            <p class="copyright">Â© 2024 JP Campus. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>const SCHOOLS_DATA = {{ schools_json | safe }};</script>
    <script src="/static/js/map.js?v=2.6"></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{ maps_api_key }}&callback=initMap&libraries=marker&v=weekly" async defer></script>
    
    <!-- [í•µì‹¬] êµ¬ê¸€ ì˜¤ë²„ë ˆì´ ê°•ì œ ì œê±° ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
    (function() {
        // ìŠ¤íƒ€ì¼ë¡œ ê°•ì œ ìˆ¨ê¹€
        const style = document.createElement('style');
        style.innerHTML = `
            .google-anno-skip, .google-anno-sc, .goog-te-banner-frame, .goog-te-balloon-frame {
                display: none !important; opacity: 0 !important; pointer-events: none !important;
            }
            body { top: 0 !important; }
        `;
        document.head.appendChild(style);

        // ìš”ì†Œ ë°œê²¬ ì¦‰ì‹œ ì‚­ì œ í•¨ìˆ˜
        function killAnnoyances() {
            document.querySelectorAll('.google-anno-skip, .google-anno-sc').forEach(el => el.remove());
        }
        
        // ì£¼ê¸°ì  ì‹¤í–‰ ë° ê°ì‹œ
        setInterval(killAnnoyances, 500); 
        const observer = new MutationObserver(killAnnoyances);
        observer.observe(document.body, { childList: true, subtree: true });
    })();
    </script>
</body>
</html>