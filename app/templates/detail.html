{% extends "base.html" %}

{# 상세 페이지 전용 심플 헤더 #}
{% block header %}
<div class="fixed-top-area" style="backdrop-filter: none; background: white;">
    <header class="main-header" style="justify-content: center; height: 80px;">
        <a href="/" class="logo"><img src="/static/img/logo.png" alt="JP Campus Logo" class="logo-img"></a>
    </header>
</div>
{% endblock %}


{% block content %}
<main class="detail-container" style="margin-top: 120px;">

    {# 뒤로가기 버튼: 가이드일 경우 /guide로, 나머지는 각 리스트로 이동 #}
    <a href="{{ '/guide' if item_type == 'guide' else ('/universities' if item_type == 'university' else '/schools') }}" class="back-to-list-btn">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        <span>Back to List</span>
    </a>

    <div class="detail-header">
        {# [FIX] item_type에 따라 다른 제목과 정보를 안전하게 표시 #}
        {% if item_type == 'guide' %}
            <span class="detail-category">{{ item.get('category', 'Guide') }}</span>
            <h1 class="detail-title">{{ item.get('title', 'Guide Detail') }}</h1>
        {% else %}
            <span class="detail-category">{{ 'University' if item_type == 'university' else 'Language School' }}</span>
            <h1 class="detail-title">{{ item.get('basic_info', {}).get('name_en') or item.get('basic_info', {}).get('name_ja') }}</h1>
            <p style="color: var(--text-gray); display: flex; align-items: center; gap: 8px;">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/></svg>
                {{ item.get('basic_info', {}).get('address', 'Address not available') }}
            </p>
        {% endif %}
    </div>

    {# 학교/대학 정보 그리드 #}
    {% if item_type != 'guide' %}
    <div class="info-grid">
        <div class="info-item">
            <div class="info-label">Capacity</div>
            <div class="info-value">{{ item.get('basic_info', {}).get('capacity') or 'N/A' }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Students</div>
            <div class="info-value">{{ item.get('stats', {}).get('international_students') or 'N/A' }}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Yearly Tuition</div>
            <div class="info-value">
                {% if item.get('tuition') and item.get('tuition').get('yearly_tuition') %}
                    ¥{{ "{:,}".format(item.get('tuition').get('yearly_tuition')) }}
                {% else %}
                    TBD
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    {# 본문 내용 #}
    <div class="detail-content">{{ content_body | safe }}</div>
</main>
{% endblock %}